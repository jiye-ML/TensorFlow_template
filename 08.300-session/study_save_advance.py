'''https://yq.aliyun.com/articles/228637?spm=5176.100239.blogcont228618.13.3661da7eOXgyMG如何保存和恢复scikit-learn训练的模型'''from sklearn.linear_model import LogisticRegressionfrom sklearn.externals import joblibfrom sklearn.datasets import load_irisfrom sklearn.model_selection import train_test_splitimport pickledata = load_iris()Xtrain, Xtest, Ytrain, Ytest = train_test_split(data.data, data.target, test_size=0.3, random_state=4)model = LogisticRegression(C=0.1, class_weight=None, dual=False, fit_intercept=True,    intercept_scaling=1, max_iter=20, multi_class='ovr', n_jobs=3,    penalty='l2', random_state=None, solver='liblinear', tol=0.0001,    verbose=0, warm_start=False)model.fit(Xtrain,Ytrain)'''    Pickle模块'''pkl_file = 'pickle_model.pkl'with open(pkl_file, 'wb') as file:    pickle.dump(model, file)# Load from filewith open(pkl_file, 'rb') as file:    pickle_model = pickle.load(file)# Calculate the accuracy score and predict target valuesscore = pickle_model.score(Xtest, Ytest)print("Test score: {0:.2f} %".format(100 * score))Ypredict = pickle_model.predict(Xtest)tuple_objects = (model, Xtrain, Ytrain, score)# Save tuplepickle.dump(tuple_objects, open("tuple_model.pkl", 'wb'))# Restore tuplepickled_model, pickled_Xtrain, pickled_Ytrain, pickled_score = pickle.load(open("tuple_model.pkl", 'rb'))'''  Joblib 模块'''joblib_file = 'joblib_model.pkl'joblib.dump(model, joblib_file)# loadjoblib_model = joblib.load(joblib_file)# Calculate the accuracy and predictionsscore = joblib_model.score(Xtest, Ytest)print("Test score: {0:.2f} %".format(100 * score))Ypredict = pickle_model.predict(Xtest)